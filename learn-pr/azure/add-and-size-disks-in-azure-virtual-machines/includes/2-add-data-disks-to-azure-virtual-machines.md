<span data-ttu-id="64d78-101">Precis som alla andra datorer använder virtuella Azure-datorer diskar för att lagra operativsystemet, programmen och data.</span><span class="sxs-lookup"><span data-stu-id="64d78-101">Just like any other computer, virtual machines in Azure use disks as a place to store an operating system, applications, and data.</span></span> <span data-ttu-id="64d78-102">Dessa diskar kallas för virtuella hårddiskar (VHD).</span><span class="sxs-lookup"><span data-stu-id="64d78-102">These disks are called virtual hard disks (VHDs).</span></span>

<span data-ttu-id="64d78-103">Vi antar att du har skapat en virtuell dator i Azure, som ska vara värd för databasen med fallhistorik som din advokatbyrå använder.</span><span class="sxs-lookup"><span data-stu-id="64d78-103">Suppose you have created a virtual machine (VM) in Azure, which will host the database of case histories that your law firm relies on.</span></span> <span data-ttu-id="64d78-104">En väl utformad diskkonfiguration är nyckeln till bra prestanda och flexibilitet för SQL Server.</span><span class="sxs-lookup"><span data-stu-id="64d78-104">A well-designed disk configuration is fundamental to good performance and resilience for SQL Server.</span></span>

<span data-ttu-id="64d78-105">I den här kursdelen får du lära dig att välja rätt konfigurationsvärden för dina diskar och hur du kopplar de diskarna till en virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="64d78-105">In this unit, you'll learn how to choose the right configuration values for your disks and how to attach those disks to a VM.</span></span>

## <a name="how-disks-are-used-by-vms"></a><span data-ttu-id="64d78-106">Hur diskar används av virtuella datorer</span><span class="sxs-lookup"><span data-stu-id="64d78-106">How disks are used by VMs</span></span>

<span data-ttu-id="64d78-107">Virtuella datorer använder diskar i tre olika syften:</span><span class="sxs-lookup"><span data-stu-id="64d78-107">VMs use disks for three different purposes:</span></span>

- <span data-ttu-id="64d78-108">**Lagring av operativsystem**.</span><span class="sxs-lookup"><span data-stu-id="64d78-108">**Operating system storage**.</span></span> <span data-ttu-id="64d78-109">Varje virtuell dator innehåller en disk som lagrar operativsystemet.</span><span class="sxs-lookup"><span data-stu-id="64d78-109">Every VM includes one disk that stores the operating system.</span></span> <span data-ttu-id="64d78-110">Den här enheten är registrerad som en SATA-enhet och märkt som C:-enheten i Windows. Den monteras på ”/” i Unix-liknande operativsystem.</span><span class="sxs-lookup"><span data-stu-id="64d78-110">This drive is registered as a SATA drive and labeled as the C: drive in Windows and mounted at "/" in Unix-like operating systems.</span></span> <span data-ttu-id="64d78-111">Den har en maximal kapacitet på 2 048 gigabyte (GB) och dess innehåll hämtas från den virtuella datoravbildning som du använde för att skapa den virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="64d78-111">It has a maximum capacity of 2048 gigabytes (GB), and its content is taken from the VM image you used to create the VM.</span></span>
- <span data-ttu-id="64d78-112">**Tillfällig lagring**.</span><span class="sxs-lookup"><span data-stu-id="64d78-112">**Temporary storage**.</span></span> <span data-ttu-id="64d78-113">Varje virtuell dator innehåller också en tillfällig virtuell hårddisk som används för sidor och växlingsfiler.</span><span class="sxs-lookup"><span data-stu-id="64d78-113">Every VM includes a temporary VHD that is used for page and swap files.</span></span> <span data-ttu-id="64d78-114">Data på den här enheten kan gå förlorade vid underhåll eller omdistribution.</span><span class="sxs-lookup"><span data-stu-id="64d78-114">Data on this drive may be lost during a maintenance event or redeployment.</span></span> <span data-ttu-id="64d78-115">Enheten är märkt som D: på en virtuell Windows-dator som standard.</span><span class="sxs-lookup"><span data-stu-id="64d78-115">The drive is labeled as D: on a Windows VM by default.</span></span> <span data-ttu-id="64d78-116">Använd inte den här enheten för att lagra viktiga data som du inte vill förlora.</span><span class="sxs-lookup"><span data-stu-id="64d78-116">Do not use this drive to store important data that you do not want to lose.</span></span>
- <span data-ttu-id="64d78-117">**Datalagring**.</span><span class="sxs-lookup"><span data-stu-id="64d78-117">**Data storage**.</span></span> <span data-ttu-id="64d78-118">En datadisk är alla andra diskar som är anslutna till en virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="64d78-118">A data disk is any other disk attached to a VM.</span></span> <span data-ttu-id="64d78-119">Du kan använda datadiskar för att lagra filer, databaser och alla andra data som du behöver bevara mellan omstarter.</span><span class="sxs-lookup"><span data-stu-id="64d78-119">You use data disks to store files, databases, and any other data that you need to persist across reboots.</span></span> <span data-ttu-id="64d78-120">Vissa virtuella datoravbildningar innefattar datadiskar som standard.</span><span class="sxs-lookup"><span data-stu-id="64d78-120">Some VM images include data disks by default.</span></span> <span data-ttu-id="64d78-121">Du kan också lägga till dina fler datadiskar upp till det maximala antal som anges av storleken på den virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="64d78-121">You can also add additional data disks up to the maximum number specified by the size of the VM.</span></span> <span data-ttu-id="64d78-122">Varje datadisk är registrerad som en SCSI-enhet och har en maximal kapacitet på 4 095 GB.</span><span class="sxs-lookup"><span data-stu-id="64d78-122">Each data disk is registered as a SCSI drive and has a max capacity of 4095 GB.</span></span> <span data-ttu-id="64d78-123">Du kan välja enhetsbeteckningar eller monteringspunkter för dina enheter.</span><span class="sxs-lookup"><span data-stu-id="64d78-123">You can choose drive letters or mount points for your data drives.</span></span>

## <a name="storing-vhd-files"></a><span data-ttu-id="64d78-124">Lagra VHD-filer</span><span class="sxs-lookup"><span data-stu-id="64d78-124">Storing VHD files</span></span>

<span data-ttu-id="64d78-125">I Azure lagras virtuella hårddiskar på ett Azure-lagringskonto som **sidblobbar**.</span><span class="sxs-lookup"><span data-stu-id="64d78-125">In Azure, VHDs are stored in an Azure storage account as **page blobs**.</span></span>

<span data-ttu-id="64d78-126">I den här tabellen visas de olika typerna av lagringskonton och vilka objekt som kan användas med vart och ett.</span><span class="sxs-lookup"><span data-stu-id="64d78-126">This table shows the various kinds of storage accounts and which objects can be used with each.</span></span>

|<span data-ttu-id="64d78-127">**Typ av lagringskonto**</span><span class="sxs-lookup"><span data-stu-id="64d78-127">**Type of storage account**</span></span>|<span data-ttu-id="64d78-128">**Allmän standard**</span><span class="sxs-lookup"><span data-stu-id="64d78-128">**General-purpose standard**</span></span>|<span data-ttu-id="64d78-129">**Allmän premium**</span><span class="sxs-lookup"><span data-stu-id="64d78-129">**General-purpose premium**</span></span>|<span data-ttu-id="64d78-130">**Blobblagring, frekvent och lågfrekvent åtkomstnivå**</span><span class="sxs-lookup"><span data-stu-id="64d78-130">**Blob storage, hot and cool access tiers**</span></span>|
|-----|-----|-----|-----|
|<span data-ttu-id="64d78-131">**Tjänster som stöds**</span><span class="sxs-lookup"><span data-stu-id="64d78-131">**Services supported**</span></span>| <span data-ttu-id="64d78-132">Azure-blobblagring, Azure Files, Azure-kölagring</span><span class="sxs-lookup"><span data-stu-id="64d78-132">Azure Blob storage, Azure Files, Azure Queue storage</span></span> | <span data-ttu-id="64d78-133">Blobblagring</span><span class="sxs-lookup"><span data-stu-id="64d78-133">Blob storage</span></span> | <span data-ttu-id="64d78-134">Blobblagring</span><span class="sxs-lookup"><span data-stu-id="64d78-134">Blob storage</span></span>|
|<span data-ttu-id="64d78-135">**Typer av blobbar som stöds**</span><span class="sxs-lookup"><span data-stu-id="64d78-135">**Types of blobs supported**</span></span>|<span data-ttu-id="64d78-136">Blockblobbar, sidblobbar och tilläggsblobbar</span><span class="sxs-lookup"><span data-stu-id="64d78-136">Block blobs, page blobs, and append blobs</span></span> | <span data-ttu-id="64d78-137">Sidblobbar</span><span class="sxs-lookup"><span data-stu-id="64d78-137">Page blobs</span></span> | <span data-ttu-id="64d78-138">Blockblobbar och bilageblobbar</span><span class="sxs-lookup"><span data-stu-id="64d78-138">Block blobs and append blobs</span></span>|

<span data-ttu-id="64d78-139">Premium- och allmän standardlagring har stöd för sidblobar.</span><span class="sxs-lookup"><span data-stu-id="64d78-139">Both General-purpose standard and premium storage support page blobs.</span></span> <span data-ttu-id="64d78-140">Välj ett standardlagringskonto om kostnaden är viktigast.</span><span class="sxs-lookup"><span data-stu-id="64d78-140">Choose a standard storage account if cost is your primary concern.</span></span> <span data-ttu-id="64d78-141">Premium storage kostar mer, men kommer också att leverera mycket högre i/o-åtgärder per sekund (IOPS).</span><span class="sxs-lookup"><span data-stu-id="64d78-141">Premium storage will cost more, but will also deliver much higher I/O operations/sec (IOPS).</span></span> <span data-ttu-id="64d78-142">Om dataprestanda är ett krav för den virtuella datorn är premiumlagring bättre.</span><span class="sxs-lookup"><span data-stu-id="64d78-142">If data performance is a requirement for your VM, prefer premium storage.</span></span>

## <a name="attach-data-disks-to-vms"></a><span data-ttu-id="64d78-143">Koppla datadiskar till virtuella datorer</span><span class="sxs-lookup"><span data-stu-id="64d78-143">Attach data disks to VMs</span></span>

<span data-ttu-id="64d78-144">Du kan lägga till datadiskar till en virtuell dator när som helst genom att koppla dem till den virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="64d78-144">You can add data disks to a virtual machine at any time by attaching them to the VM.</span></span> <span data-ttu-id="64d78-145">När du ansluter en disk associeras VHD-filen med den virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="64d78-145">Attaching a disk associates the VHD file with the VM.</span></span> 

<span data-ttu-id="64d78-146">Den virtuella hårddisken kan inte tas bort från lagringen när den är ansluten.</span><span class="sxs-lookup"><span data-stu-id="64d78-146">The VHD can't be deleted from storage while it's attached.</span></span>

### <a name="attach-an-existing-data-disk-to-an-azure-vm"></a><span data-ttu-id="64d78-147">Koppla en befintlig datadisk till en virtuell Azure-dator</span><span class="sxs-lookup"><span data-stu-id="64d78-147">Attach an existing data disk to an Azure VM</span></span>

<span data-ttu-id="64d78-148">Du kanske redan har en virtuell hårddisk som lagrar data som du vill använda i din virtuella Azure-dator.</span><span class="sxs-lookup"><span data-stu-id="64d78-148">You may already have a VHD that stores the data you want to use in your Azure VM.</span></span> <span data-ttu-id="64d78-149">I vårt scenario med advokatbyrån kanske du redan har konverterat dina fysiska diskar till virtuella hårddiskar lokalt.</span><span class="sxs-lookup"><span data-stu-id="64d78-149">In our law firm scenario, for example,  perhaps you've already converted your physical disks to VHDs locally.</span></span> <span data-ttu-id="64d78-150">I det här fallet kan du använda PowerShell-cmdleten `Add-AzureRmVhd` till att överföra den till lagringskontot.</span><span class="sxs-lookup"><span data-stu-id="64d78-150">In this case, you can use the PowerShell `Add-AzureRmVhd` cmdlet to upload it to the storage account.</span></span> <span data-ttu-id="64d78-151">Denna cmdlet är optimerad för att överföra VHD-filer och kan slutföra överföringen snabbare än andra metoder.</span><span class="sxs-lookup"><span data-stu-id="64d78-151">This cmdlet is optimized for transferring VHD files and may complete the upload faster than other methods.</span></span> <span data-ttu-id="64d78-152">Överföringen slutförs med hjälp av flera trådar för att få bästa prestanda.</span><span class="sxs-lookup"><span data-stu-id="64d78-152">The transfer is completed by using multiple threads for best performance.</span></span> <span data-ttu-id="64d78-153">När den virtuella hårddisken har överförts, kopplar du den till en befintlig virtuell dator som en datadisk.</span><span class="sxs-lookup"><span data-stu-id="64d78-153">Once the VHD has been uploaded, attach it to an existing VM as a data disk.</span></span> <span data-ttu-id="64d78-154">Det här är en utmärkt metod för att distribuera alla typer av data till virtuella Azure-datorer.</span><span class="sxs-lookup"><span data-stu-id="64d78-154">This approach an excellent way to deploy data of all types to Azure VMs.</span></span> <span data-ttu-id="64d78-155">Datan finns automatiskt i den virtuella datorn och du behöver inte partitionera eller formatera den nya disken.</span><span class="sxs-lookup"><span data-stu-id="64d78-155">The data is automatically present in the VM, and there's no need to partition or format the new disk.</span></span>

### <a name="attach-a-new-data-disk-to-an-azure-vm"></a><span data-ttu-id="64d78-156">Koppla en ny datadisk till en virtuell Azure-dator</span><span class="sxs-lookup"><span data-stu-id="64d78-156">Attach a new data disk to an Azure VM</span></span>

<span data-ttu-id="64d78-157">Du kan använda Azure Portal för att lägga till en ny, tom datadisk till en virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="64d78-157">You can use the Azure portal to add a new, empty data disk to a VM.</span></span> 

<span data-ttu-id="64d78-158">Processen skapar en **.vhd**-fil som en sidblobb i lagringskontot som du anger, samt kopplar .vhd-filen som en datadisk till den virtuella datorn.</span><span class="sxs-lookup"><span data-stu-id="64d78-158">This process will create a **.vhd** file as a page blob in the storage account that you specify, and attach that .vhd file as a data disk to the VM.</span></span>

<span data-ttu-id="64d78-159">Innan du kan använda den nya virtuella hårddisken för att lagra data, måste du initiera, partitionera och formatera den nya disken.</span><span class="sxs-lookup"><span data-stu-id="64d78-159">Before you can use the new VHD to store data, you have to initialize, partition, and format the new disk.</span></span> <span data-ttu-id="64d78-160">Vi ska öva på de här stegen i nästa övning.</span><span class="sxs-lookup"><span data-stu-id="64d78-160">We'll practice these steps in the next exercise.</span></span>

<span data-ttu-id="64d78-161">I fysiska, lokala servrar lagrar du data på fysiska hårddiskar.</span><span class="sxs-lookup"><span data-stu-id="64d78-161">In physical on-premises servers, you store data on physical hard disks.</span></span> <span data-ttu-id="64d78-162">Du lagrar data på en virtuell Azure-dator på virtuella hårddiskar (VHD:er).</span><span class="sxs-lookup"><span data-stu-id="64d78-162">You store data in an Azure virtual machine (VM) on virtual hard disks (VHDs).</span></span> <span data-ttu-id="64d78-163">Dessa virtuella hårddiskar lagras på Azure-lagringskonton som sidblobbar.</span><span class="sxs-lookup"><span data-stu-id="64d78-163">These VHDs are stored as page blobs in Azure storage accounts.</span></span> <span data-ttu-id="64d78-164">När du exempelvis migrerar din advokatbyrås databas med fallhistorik till Azure, måste du skapa virtuella hårddiskar där databasfilerna ska sparas.</span><span class="sxs-lookup"><span data-stu-id="64d78-164">For example, when you migrate your law firm's database of case histories to Azure, you must create VHDs where the database files will be saved.</span></span>
