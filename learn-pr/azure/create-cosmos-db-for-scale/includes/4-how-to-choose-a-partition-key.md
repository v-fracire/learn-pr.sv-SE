<span data-ttu-id="27650-101">Onlineåterförsäljaren som du arbetar för planerar att inom kort utöka till ett nytt geografiskt område.</span><span class="sxs-lookup"><span data-stu-id="27650-101">The online retailer that you work for plans to expand to a new geographical area soon.</span></span> <span data-ttu-id="27650-102">Flytten utökar din kundbas och dina transaktionsvolymer.</span><span class="sxs-lookup"><span data-stu-id="27650-102">This move will increase your customer base and transaction volume.</span></span> <span data-ttu-id="27650-103">Du måste se till att din databas klarar att hantera expansion när så krävs.</span><span class="sxs-lookup"><span data-stu-id="27650-103">You must ensure that your database is equipped to handle expansion whenever required.</span></span>

<span data-ttu-id="27650-104">Om du har en partitionsstrategi säkerställer det att när din databas behöver växa kan den enkelt göra det och fortsätta att utföra effektiva frågor och transaktioner.</span><span class="sxs-lookup"><span data-stu-id="27650-104">Having a partition strategy ensures that when your database needs to grow, it can do so easily and continue to perform efficient queries and transactions.</span></span>

## <a name="what-is-a-partition-strategy"></a><span data-ttu-id="27650-105">Vad är en strategi för partition?</span><span class="sxs-lookup"><span data-stu-id="27650-105">What is a partition strategy?</span></span>

<span data-ttu-id="27650-106">Om du fortsätter att lägga till nya data till en enskild server eller en enskild partition får du så småningom slut på utrymme.</span><span class="sxs-lookup"><span data-stu-id="27650-106">If you continue to add new data to a single server or a single partition, it will eventually run out of space.</span></span> <span data-ttu-id="27650-107">För att förbereda för det behöver du en partitioneringsstrategi för att **skala ut** istället för upp.</span><span class="sxs-lookup"><span data-stu-id="27650-107">To prepare for this, you need a partitioning strategy to **scale out** instead of up.</span></span> <span data-ttu-id="27650-108">Att skala ut kallas även för horisontell skalning, och det gör att du kan lägga till fler partitioner till din databas när ditt program behöver det.</span><span class="sxs-lookup"><span data-stu-id="27650-108">Scaling out is also called horizontal scaling, and it enables you to add more partitions to your database as your application needs them.</span></span>

<span data-ttu-id="27650-109">Partitionen och utskalningsstrategin i Azure Cosmos DB drivs av partitionsnyckeln, vilket är ett värde som ställs in när du skapar en samling.</span><span class="sxs-lookup"><span data-stu-id="27650-109">The partition and scale-out strategy in Azure Cosmos DB is driven by the partition key, which is a value set when you create a collection.</span></span> <span data-ttu-id="27650-110">När partitionsnyckeln är inställd går det inte att ändra den utan att återskapa samlingen, så det är viktigt att välja rätt partitionsnyckel tidigt i utvecklingsprocessen.</span><span class="sxs-lookup"><span data-stu-id="27650-110">Once the partition key is set, it cannot be changed without recreating the collection, so selecting the right partition key is an important decision to make early in your development process.</span></span>  

<span data-ttu-id="27650-111">I den här delen får du lära dig att välja en partitionsnyckel som är rätt för ditt scenario och som drar nytta av den autoskalning som Azure Cosmos DB kan göra åt dig.</span><span class="sxs-lookup"><span data-stu-id="27650-111">In this unit, you will learn how to choose a partition key that's right for your scenario and will take advantage of the autoscaling that Azure Cosmos DB can do for you.</span></span>

## <a name="what-is-a-partition-key"></a><span data-ttu-id="27650-112">Vad är en partitionsnyckel?</span><span class="sxs-lookup"><span data-stu-id="27650-112">What is a partition key?</span></span>

<span data-ttu-id="27650-113">En partitionsnyckel är det värde Azure använder för att organisera dina data i logiska avdelningar.</span><span class="sxs-lookup"><span data-stu-id="27650-113">A partition key is the value by which Azure organizes your data into logical divisions.</span></span> <span data-ttu-id="27650-114">I vårt scenario med en onlinebutik är det ett bra val att använda värdet `userID` eller `productId` som partitionsnyckel eftersom den blir unik och kommer sannolikt att användas för att slå upp poster.</span><span class="sxs-lookup"><span data-stu-id="27650-114">In our online retail scenario, using the `userID` or `productId` value as the partition key is a good choice because it will be unique and likely used to lookup records.</span></span> <span data-ttu-id="27650-115">`userID` är ett bra val, eftersom ditt program ofta behöver hämta anpassningsinställningar, kundvagn, orderhistorik och profilinformation för användaren, för att bara nämna några.</span><span class="sxs-lookup"><span data-stu-id="27650-115">`userID` is a good choice, as your application frequently needs to retrieve the personalization settings, shopping cart, order history, and profile information for the user, just to name a few.</span></span> <span data-ttu-id="27650-116">`productId` är också ett bra val, eftersom programmet måste fråga lagernivåer, leveranskostnader, färgalternativ, lagerplatser med mera.</span><span class="sxs-lookup"><span data-stu-id="27650-116">`productId` is also a good choice, as your application needs to query inventory levels, shipping costs, color options, warehouse locations, and more.</span></span>

<span data-ttu-id="27650-117">En partitionsnyckel bör syfta till att distribuera åtgärder i databasen.</span><span class="sxs-lookup"><span data-stu-id="27650-117">A partition key should aim to distribute operations across the database.</span></span> <span data-ttu-id="27650-118">Du vill distribuera begäranden för att undvika heta partitioner.</span><span class="sxs-lookup"><span data-stu-id="27650-118">You want to distribute requests to avoid hot partitions.</span></span> <span data-ttu-id="27650-119">En frekvent partition (hot partition) är en enda partition som får många fler begäran än de andra. Det kan skapa en flaskhals för dataflödet.</span><span class="sxs-lookup"><span data-stu-id="27650-119">A hot partition is a single partition that receives many more requests than the others, which can create a throughput bottleneck.</span></span> <span data-ttu-id="27650-120">För exempelvis ditt e-handelsprogram skulle den aktuella tiden vara ett dåligt val av partitionsnyckel, eftersom alla inkommande data skulle gå till en enda partitionsnyckel.</span><span class="sxs-lookup"><span data-stu-id="27650-120">For example, for your e-commerce application, the current time would be a poor choice of partition key, because all the incoming data would go to a single partition key.</span></span> <span data-ttu-id="27650-121">`userID` eller `productId` skulle passa bättre, eftersom alla användare på webbplatsen troligtvis skulle lägga till och uppdatera sin kundvagn eller profilinformation med ungefär samma frekvens, vilket distribuerar läsningar och skrivningar i alla användar- och produktpartitioner.</span><span class="sxs-lookup"><span data-stu-id="27650-121">`userID` or `productId` would be better, as all the users on your site would likely be adding and updating their shopping cart or profile information at about the same frequency, which distributes the reads and writes across all the user and product partitions.</span></span>

<span data-ttu-id="27650-122">Lagringsutrymmet för varje partitionsnyckel får inte överskrida 10 GB, vilket är storleken på en fysisk partition i Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="27650-122">The storage space for the data associated with each partition key cannot exceed 10 GB, which is the size of one physical partition in Azure Cosmos DB.</span></span> <span data-ttu-id="27650-123">Så om din enskilda post för `userID` eller `productId` kommer att överstiga 10 GB ska du fundera på att använda en sammansatt nyckel istället, så att varje post blir mindre.</span><span class="sxs-lookup"><span data-stu-id="27650-123">So, if your single `userID` or `productId` record is going to be larger than 10 GB, think about using a composite key instead so that each record is smaller.</span></span> <span data-ttu-id="27650-124">Ett exempel på en sammansatt nyckel är `userID-date`, vilket skulle se ut så här: **CustomerName-08072018**.</span><span class="sxs-lookup"><span data-stu-id="27650-124">An example of a composite key would be `userID-date`, which would look like **CustomerName-08072018**.</span></span> <span data-ttu-id="27650-125">Metoden med sammansatt nyckel skulle göra det möjligt för dig att skapa en ny partition för varje dag som en användare besökte webbplatsen.</span><span class="sxs-lookup"><span data-stu-id="27650-125">This composite key approach would enable you to create a new partition for each day a user visited the site.</span></span>

## <a name="best-practices"></a><span data-ttu-id="27650-126">Bästa praxis</span><span class="sxs-lookup"><span data-stu-id="27650-126">Best practices</span></span>

<span data-ttu-id="27650-127">När du försöker bestämma rätt sammansatt nyckel och lösningen inte är uppenbar får du här några tips på vad du kan tänka på.</span><span class="sxs-lookup"><span data-stu-id="27650-127">When you're trying to determine the right partition key and the solution isn't obvious, here are a few tips to keep in mind.</span></span>

- <span data-ttu-id="27650-128">Var inte rädd för att välja en partitionsnyckel som har ett stort antal värden.</span><span class="sxs-lookup"><span data-stu-id="27650-128">Don’t be afraid of choosing a partition key that has a large number of values.</span></span> <span data-ttu-id="27650-129">Ju fler värden dina partitionsnycklar har, desto mer skalbarhet får du.</span><span class="sxs-lookup"><span data-stu-id="27650-129">The more values your partition key has, the more scalability you have.</span></span>
- <span data-ttu-id="27650-130">För att bestämma vilken partitionsnyckel som är bäst för en arbetsbelastning som är mer inriktad på läsning tar du en titt på de tre till fem översta frågorna du tänker använda.</span><span class="sxs-lookup"><span data-stu-id="27650-130">To determine the best partition key for a read-heavy workload, review the top three to five queries you plan on using.</span></span> <span data-ttu-id="27650-131">Värdet som oftast ingår i WHERE-satsen är en stark kandidat för partitionsnyckeln.</span><span class="sxs-lookup"><span data-stu-id="27650-131">The value most frequently included in the WHERE clause is a good candidate for the partition key.</span></span>
- <span data-ttu-id="27650-132">För arbetsbelastningar som är mer inriktade på skrivning måste du förstå arbetsbelastningens transaktionsbehov, eftersom partitionsnyckeln omfattar transaktioner för flera dokument.</span><span class="sxs-lookup"><span data-stu-id="27650-132">For write-heavy workloads, you'll need to understand the transactional needs of your workload, because the partition key is the scope of multi-document transactions.</span></span>
