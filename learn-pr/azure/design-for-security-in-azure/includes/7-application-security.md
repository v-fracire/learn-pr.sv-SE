<span data-ttu-id="bc46b-101">Att använda en molnplattform som värd för program ger flera fördelar jämfört med traditionella lokala distributioner.</span><span class="sxs-lookup"><span data-stu-id="bc46b-101">Hosting applications on a cloud platform provides a number of advantages when compared to traditional on-premises deployments.</span></span> <span data-ttu-id="bc46b-102">Molnets modell för delat ansvar innebär att kontrollen över säkerheten på nivån för fysiska nätverk, utveckling och värdhantering flyttas till molnleverantören.</span><span class="sxs-lookup"><span data-stu-id="bc46b-102">The cloud's shared-responsibility model moves security at the physical network, building, and host levels under the control of the cloud provider.</span></span> <span data-ttu-id="bc46b-103">Angreppsförsök mot plattformen på den här nivån lönar sig sällan med tanke på de stora investeringar som leverantörerna gör för att skydda och övervaka sina infrastrukturer.</span><span class="sxs-lookup"><span data-stu-id="bc46b-103">An attacker trying to compromise the platform at this level would see diminishing returns versus the considerable investment and insight providers make in securing and monitoring their infrastructure.</span></span>

<span data-ttu-id="bc46b-104">Därför är det mycket effektivare för angripare att rikta in sig på säkerhetsbrister som introduceras av molnplattformens kunder på programnivå.</span><span class="sxs-lookup"><span data-stu-id="bc46b-104">It's therefore far more effective for attackers to pursue vulnerabilities introduced at the application level by cloud-platform customers.</span></span> <span data-ttu-id="bc46b-105">Kunder som väljer att hantera sina program i PaaS (Platform as a Service) kan dessutom frigöra resurser som arbetar med operativsystemssäkerhet så att de i stället kan fokusera på programkoden och identitetssäkerheten i anslutning till programmet.</span><span class="sxs-lookup"><span data-stu-id="bc46b-105">Furthermore, by adopting Platform as a Service (PaaS) to host their applications, customers are able to free resources from managing operating system security and deploy them to harden application code and monitor the identity perimeter around the application.</span></span> <span data-ttu-id="bc46b-106">I den här delen går vi igenom några exempel på hur programsäkerheten kan förbättras genom design.</span><span class="sxs-lookup"><span data-stu-id="bc46b-106">In this unit we will discuss some of the ways application security can be improved through design.</span></span>

## <a name="scenario"></a><span data-ttu-id="bc46b-107">Scenario</span><span class="sxs-lookup"><span data-stu-id="bc46b-107">Scenario</span></span>

<span data-ttu-id="bc46b-108">Lamna Healthcares kunder behöver åtkomst till personliga läkarjournaler via en webbportal.</span><span class="sxs-lookup"><span data-stu-id="bc46b-108">Lamna Healthcare customers require access to their personal medical records through an online web portal.</span></span> <span data-ttu-id="bc46b-109">Företaget måste uppfylla kraven i HIPAA (Health Insurance Portability and Accountability Act). Läckage av personliga data på grund av intrång i företagets system kan leda till allvarliga ekonomiska påföljder. Att skydda programdata och personliga data har därför högsta prioritet för företaget.</span><span class="sxs-lookup"><span data-stu-id="bc46b-109">Compliance with the Health Insurance Portability and Accountability Act (HIPAA) is mandatory and puts the company at significant risk of financial penalties if a breach of personal data occurs; therefore, securing the application and personal data it interacts with is paramount.</span></span>

<span data-ttu-id="bc46b-110">De viktigaste områdena som rör kundtillämpningar är:</span><span class="sxs-lookup"><span data-stu-id="bc46b-110">The primary areas that concern customer applications are:</span></span>

- <span data-ttu-id="bc46b-111">Säker programdesign</span><span class="sxs-lookup"><span data-stu-id="bc46b-111">Secure application design</span></span>
- <span data-ttu-id="bc46b-112">Datasäkerhet</span><span class="sxs-lookup"><span data-stu-id="bc46b-112">Data security</span></span>
- <span data-ttu-id="bc46b-113">Identitets- och åtkomsthantering</span><span class="sxs-lookup"><span data-stu-id="bc46b-113">Identity and access management</span></span>
- <span data-ttu-id="bc46b-114">Slutpunktssäkerhet</span><span class="sxs-lookup"><span data-stu-id="bc46b-114">Endpoint security</span></span>

## <a name="security-development-lifecycle"></a><span data-ttu-id="bc46b-115">Säkerhetsutvecklingslivscykel</span><span class="sxs-lookup"><span data-stu-id="bc46b-115">Security Development Lifecycle</span></span>

<span data-ttu-id="bc46b-116">Microsofts [SDL-process](https://www.microsoft.com/sdl) för säkerhetsutvecklingslivscykeln (Security Development Lifecycle) kan användas under designfasen för att säkerställa att viktiga säkerhetsfrågor hanteras under programvaruutvecklingens livscykel.</span><span class="sxs-lookup"><span data-stu-id="bc46b-116">Microsoft's [Security Development Lifecycle](https://www.microsoft.com/sdl) (SDL) process can be used during the application design stage to ensure security concerns are incorporated in the software development lifecycle.</span></span> <span data-ttu-id="bc46b-117">Säkerhets- och efterlevnadsproblem är mycket enklare att hantera när du utformar ett program och kan minimera risken för många vanliga fel som kan leda till säkerhetsbrister i den slutliga produkten.</span><span class="sxs-lookup"><span data-stu-id="bc46b-117">Security and compliance issues are far easier to address when designing an application and can mitigate many common errors that can lead to security flaws in the final product.</span></span> <span data-ttu-id="bc46b-118">Det är också mycket mindre kostsamt att åtgärda problem i ett tidigt skede under programvaruutvecklingen.</span><span class="sxs-lookup"><span data-stu-id="bc46b-118">Fixing issues early in the software development journey is also far less costly.</span></span> <span data-ttu-id="bc46b-119">Stegen i SDL-processen för ett programvaruprojekt utförs normalt i följande ordning:</span><span class="sxs-lookup"><span data-stu-id="bc46b-119">The typical sequence of SDL steps a software project can use are as follows:</span></span>

1. <span data-ttu-id="bc46b-120">Utbildning</span><span class="sxs-lookup"><span data-stu-id="bc46b-120">Training</span></span>

    - <span data-ttu-id="bc46b-121">Grundläggande säkerhetsutbildning</span><span class="sxs-lookup"><span data-stu-id="bc46b-121">Core security training</span></span>

1. <span data-ttu-id="bc46b-122">Krav</span><span class="sxs-lookup"><span data-stu-id="bc46b-122">Requirements</span></span>

    - <span data-ttu-id="bc46b-123">Definiera krav och kvalitet</span><span class="sxs-lookup"><span data-stu-id="bc46b-123">Define requirements and quality gates</span></span>
    - <span data-ttu-id="bc46b-124">Analysera säkerhets- och integritetsrisker</span><span class="sxs-lookup"><span data-stu-id="bc46b-124">Analyze security and privacy risks</span></span>
 
1. <span data-ttu-id="bc46b-125">Design</span><span class="sxs-lookup"><span data-stu-id="bc46b-125">Design</span></span>

    - <span data-ttu-id="bc46b-126">Analysera attackyta</span><span class="sxs-lookup"><span data-stu-id="bc46b-126">Attack surface analysis</span></span>
    - <span data-ttu-id="bc46b-127">Hotmodellering</span><span class="sxs-lookup"><span data-stu-id="bc46b-127">Threat modeling</span></span>
 
1. <span data-ttu-id="bc46b-128">Implementering</span><span class="sxs-lookup"><span data-stu-id="bc46b-128">Implementation</span></span>

    - <span data-ttu-id="bc46b-129">Ange verktyg för att säkerställa att kodkvaliteten kan mätas</span><span class="sxs-lookup"><span data-stu-id="bc46b-129">Specify tools to ensure code quality can be measured</span></span>
    - <span data-ttu-id="bc46b-130">Tillämpa regler för förbjudna API:er och funktioner</span><span class="sxs-lookup"><span data-stu-id="bc46b-130">Enforce banned APIs and functions</span></span>
    - <span data-ttu-id="bc46b-131">Utföra analys av statisk kod</span><span class="sxs-lookup"><span data-stu-id="bc46b-131">Perform static code analysis</span></span>
    - <span data-ttu-id="bc46b-132">Genomsöka lagringsplatser efter lagrade hemligheter</span><span class="sxs-lookup"><span data-stu-id="bc46b-132">Scan repositories for stored secrets</span></span>
 
1. <span data-ttu-id="bc46b-133">Verifiering</span><span class="sxs-lookup"><span data-stu-id="bc46b-133">Verification</span></span>

    - <span data-ttu-id="bc46b-134">Dynamisk testning/fuzztestning</span><span class="sxs-lookup"><span data-stu-id="bc46b-134">Dynamic/Fuzz testing</span></span>
    - <span data-ttu-id="bc46b-135">Verifiera hotmodeller/attackyta</span><span class="sxs-lookup"><span data-stu-id="bc46b-135">Verify threat models/attack surface</span></span>
 
1. <span data-ttu-id="bc46b-136">Utgivning</span><span class="sxs-lookup"><span data-stu-id="bc46b-136">Release</span></span>

    - <span data-ttu-id="bc46b-137">Definiera säkerhetsåtgärdsplan</span><span class="sxs-lookup"><span data-stu-id="bc46b-137">Form security response plan</span></span>
    - <span data-ttu-id="bc46b-138">Genomför en slutlig säkerhetsgranskning</span><span class="sxs-lookup"><span data-stu-id="bc46b-138">Perform a final security review</span></span>
    - <span data-ttu-id="bc46b-139">Utgivningsarkiv</span><span class="sxs-lookup"><span data-stu-id="bc46b-139">Release archive</span></span>
 
1. <span data-ttu-id="bc46b-140">Svarsåtgärder</span><span class="sxs-lookup"><span data-stu-id="bc46b-140">Response</span></span> 

    - <span data-ttu-id="bc46b-141">Verkställ svarsåtgärder vid hot</span><span class="sxs-lookup"><span data-stu-id="bc46b-141">Execute threat response execution</span></span>

![En illustraton som visar livscykler för säkerhetsutveckling](../media/sdl.png)

<span data-ttu-id="bc46b-143">SDL är både en kulturell aspekt och en process eller uppsättning verktyg.</span><span class="sxs-lookup"><span data-stu-id="bc46b-143">The SDL is as much a cultural aspect as it is a process or set of tools.</span></span> <span data-ttu-id="bc46b-144">Att skapa en kultur där säkerheten har hög prioritet inom all programutveckling är ett viktigt steg i en organisations säkerhetsoptimering.</span><span class="sxs-lookup"><span data-stu-id="bc46b-144">Building a culture where security is a primary focus and requirement of any application development can make great strides in evolving an organization's capabilities around security.</span></span>

<!-- Bear in mind that the migration of un-modified applications (especially COTS procured software systems) will not be able to perform many of the steps listed above.
 -->

## <a name="operational-security-assessment"></a><span data-ttu-id="bc46b-145">Driftsäkerhetsutvärdering</span><span class="sxs-lookup"><span data-stu-id="bc46b-145">Operational security assessment</span></span>

<span data-ttu-id="bc46b-146">När ett program har distribuerats är det viktigt att löpande utvärdera säkerheten i programmet, att avgöra hur problem som identifieras kan åtgärdas och undvikas, samt att integrera denna kunskap i programvaruutvecklingscykeln.</span><span class="sxs-lookup"><span data-stu-id="bc46b-146">Once an application has been deployed, it's essential to continually evaluate its security posture, determine how to mitigate any issues that are discovered, and feed the knowledge back into the software development cycle.</span></span> <span data-ttu-id="bc46b-147">I hur hög grad detta görs är kopplat till programvaruutvecklingens och driftteamens mognadsnivå och till kraven på dataintegritet.</span><span class="sxs-lookup"><span data-stu-id="bc46b-147">The depth to which this is performed is a factor of the maturity level of the software development and operational teams as well as the data privacy requirements.</span></span>

<span data-ttu-id="bc46b-148">Programvarutjänster som söker efter säkerhetsbrister kan användas för att automatisera den här processen och för att regelbundet utvärdera säkerhetsproblem så att kostsamma manuella processer, t.ex. penetrationstester, kan undvikas.</span><span class="sxs-lookup"><span data-stu-id="bc46b-148">Security vulnerability scanning software services are available to help automate this process and assess security concerns on a regular cadence, without burdening teams with costly manual processes, such as penetration testing.</span></span>

<span data-ttu-id="bc46b-149">Azure Security Center är en kostnadsfri tjänst som nu är aktiverad som standard för alla Azure-prenumerationer. Tjänsten är nära integrerad med andra tjänster på Azure-programnivå som Azure Application Gateway och Azure Web Application Firewall.</span><span class="sxs-lookup"><span data-stu-id="bc46b-149">Azure Security Center is a free service, now enabled by default for all Azure subscriptions, that is tightly integrated with other Azure application level services, such as Azure Application Gateway and Azure Web Application Firewall.</span></span> <span data-ttu-id="bc46b-150">Genom att analysera loggar från dessa tjänster kan ASC rapportera om kända problem i realtid och rekommendera lämpliga åtgärder, samt även konfigureras att automatiskt köra spelböcker som svar på attacker.</span><span class="sxs-lookup"><span data-stu-id="bc46b-150">By analyzing logs from these services, ASC can report on known vulnerabilities in real time, recommend responses to mitigate them, and even be configured to automatically execute playbooks in response to attacks.</span></span>

<!-- SDL culture
Key Vault / MSI
CSE = App  -> DB & App Storage
Mention approach of code scanning & SDL
Scanning for passwords - Git
 -->

## <a name="identity-as-the-perimeter"></a><span data-ttu-id="bc46b-151">Identitet som perimeter</span><span class="sxs-lookup"><span data-stu-id="bc46b-151">Identity as the perimeter</span></span>

<span data-ttu-id="bc46b-152">Identitetsverifiering är i allt högre utsträckning den första skyddsbarriären för program.</span><span class="sxs-lookup"><span data-stu-id="bc46b-152">Identity validation is becoming the first line in defense for applications.</span></span> <span data-ttu-id="bc46b-153">Att begränsa åtkomsten till ett webbprogram genom autentiserings- och auktoriseringssessioner kan drastiskt minska angreppsytan.</span><span class="sxs-lookup"><span data-stu-id="bc46b-153">Restricting access to a web application by authenticating and authorizing sessions can drastically reduce the attack surface area.</span></span> <span data-ttu-id="bc46b-154">Azure AD och Azure AD B2C erbjuder ett effektivt sätt att överlåta ansvaret för identitets- och åtkomsthanteringen till en helt hanterad tjänst.</span><span class="sxs-lookup"><span data-stu-id="bc46b-154">Azure AD and Azure AD B2C offer an effective way to offload the responsibility of identity and access to a fully managed service.</span></span> <span data-ttu-id="bc46b-155">Azure AD-principer för villkorlig åtkomst, Privileged Identity Management och Identity Protection-kontroller förbättrar ytterligare en kunds möjlighet att förebygga obehörig åtkomst och att granska ändringar.</span><span class="sxs-lookup"><span data-stu-id="bc46b-155">Azure AD conditional access policies, privileged identity management, and Identity Protection controls further enhance a customer's ability to prevent unauthorized access and audit changes.</span></span>

## <a name="data-protection"></a><span data-ttu-id="bc46b-156">Dataskydd</span><span class="sxs-lookup"><span data-stu-id="bc46b-156">Data protection</span></span>

<span data-ttu-id="bc46b-157">Kunddata är målet för de flesta, om inte alla, attacker mot webbprogram.</span><span class="sxs-lookup"><span data-stu-id="bc46b-157">Customer data is the target for most, if not all attacks against web applications.</span></span> <span data-ttu-id="bc46b-158">Säker lagring och transport av data mellan ett program och datalagringsskiktet är helt avgörande.</span><span class="sxs-lookup"><span data-stu-id="bc46b-158">The secure storage and transport of data between an application and its data storage layer is paramount.</span></span>

<span data-ttu-id="bc46b-159">Lamna Healthcare lagrar och använder mycket känslig medicinsk patientinformation.</span><span class="sxs-lookup"><span data-stu-id="bc46b-159">Lamna Healthcare stores and accesses particularly sensitive patient medical record data.</span></span> <span data-ttu-id="bc46b-160">HIPAA antogs av USA:s kongress 1996 och definierar, jämte andra kontroller, nationella standarder för elektroniska transaktioner av vårdgivare och arbetsgivare inom hälsovården.</span><span class="sxs-lookup"><span data-stu-id="bc46b-160">HIPAA, enacted by the United States Congress in 1996, among other controls, defines the national standards for electronic healthcare transactions by healthcare providers and employers.</span></span> <span data-ttu-id="bc46b-161">Lamna måste se till att patienter och behöriga parter, t.ex. deras läkare, har säker åtkomst till medicinsk information.</span><span class="sxs-lookup"><span data-stu-id="bc46b-161">Lamna must ensure patients and authorized parties, such as their physicians, have secure access to medical data.</span></span>

<span data-ttu-id="bc46b-162">För att uppfylla dessa hårda krav har Lamna Healthcare ändrat sina program så att all patientinformation krypteras, både vilande data och under överföring.</span><span class="sxs-lookup"><span data-stu-id="bc46b-162">To comply with these requirements, Lamna Healthcare has modified their applications to encrypt all patient data at rest and in transit.</span></span> <span data-ttu-id="bc46b-163">Exempelvis används TLS (Transport Layer Security) för att kryptera data som skickas mellan webbprogrammet och SQL-databaserna på serversidan.</span><span class="sxs-lookup"><span data-stu-id="bc46b-163">For example, Transport Layer Security (TLS) is used to encrypt data exchanged between the web application and back-end SQL databases.</span></span> <span data-ttu-id="bc46b-164">Data krypteras också i viloläge i SQL Server med hjälp av TDE (Transparent Data Encryption). Det betyder att, även om miljön komprometteras, så är informationen oanvändbar för alla som saknar rätt krypteringsnycklar.</span><span class="sxs-lookup"><span data-stu-id="bc46b-164">Data is also encrypted at rest in SQL Server using Transparent Data Encryption (TDE), ensuring that even if the environment is compromised, data is effectively useless to anyone without the correct decryption keys.</span></span>

<span data-ttu-id="bc46b-165">För kryptering av data som lagras i blobblagring kan kryptering på klientsidan användas så att data som finns i minnet krypteras innan den skrivs till lagringstjänsten.</span><span class="sxs-lookup"><span data-stu-id="bc46b-165">To encrypt data stored in blob storage, client-side encryption can be used to encrypt the data in memory before it's written to the storage service.</span></span> <span data-ttu-id="bc46b-166">Bibliotek som stöder den här typen av kryptering är tillgängliga för .NET, Java och Python och gör det möjligt att integrera datakryptering direkt i program för att förbättra dataintegriteten.</span><span class="sxs-lookup"><span data-stu-id="bc46b-166">Libraries supporting this encryption are available for .NET, Java, and Python, and enable the integration of data encryption directly into applications to enhance data integrity.</span></span>

### <a name="secure-key-and-secret-storage"></a><span data-ttu-id="bc46b-167">Säker lagring av nycklar och hemligheter</span><span class="sxs-lookup"><span data-stu-id="bc46b-167">Secure key and secret storage</span></span>

<span data-ttu-id="bc46b-168">Det är viktigt att programhemligheter (anslutningssträngar, lösenord osv.) och krypteringsnycklar hålls åtskilda från programmet som används för att komma åt data.</span><span class="sxs-lookup"><span data-stu-id="bc46b-168">Separating application secrets (connection strings, passwords, etc.) and encryption keys from the application used to access data is vital.</span></span> <span data-ttu-id="bc46b-169">Krypteringsnycklar och programhemligheter bör aldrig lagras i programkoden för konfigurationsfiler.</span><span class="sxs-lookup"><span data-stu-id="bc46b-169">Encryption keys and application secrets should never be stored in the application code of configuration files.</span></span> <span data-ttu-id="bc46b-170">I stället bör en säker lagringsplats som Azure Key Vault användas.</span><span class="sxs-lookup"><span data-stu-id="bc46b-170">Instead, a secure store such as Azure Key Vault should be used.</span></span> <span data-ttu-id="bc46b-171">Åtkomst till dessa känsliga data kan sedan begränsas till programidentiteter via hanterade tjänstidentiteter, och nycklarna kan roteras med jämna mellanrum för att begränsa exponeringen och skydda mot läckage av krypteringsnycklar.</span><span class="sxs-lookup"><span data-stu-id="bc46b-171">Access to this sensitive data can then be limited to application identities through Managed Service Identities, and keys can be rotated on a regular basis to limit exposure in the case of encryption key leakage.</span></span> <span data-ttu-id="bc46b-172">Kunder kan också välja att använda sina egna krypteringsnycklar som genererats av lokala maskinvarusäkerhetsmoduler (HSM) och kan även begära att Azure Key Vault-instanser implementeras i diskreta HSM-moduler för en enskild klientorganisation.</span><span class="sxs-lookup"><span data-stu-id="bc46b-172">Customers can also choose to use their own encryption keys generated by on-premises Hardware Security Modules (HSM) and even mandate that Azure Key Vault instances are implemented in single-tenant, discrete HSMs.</span></span>

<!-- ### Secure and immutable file storage

All Azure storage accounts are encrypted by default using Microsoft managed keys. Azure customers also have the ability to use their own encryption keys (BYOK) to encrypt blob, file and queue data so that even the hosting provider has no access to unencrypted data. Data immutability is often required for auditing purposes or when legal disputes call for data to be effectively frozen for a determined amount of time. Azure has recently introduced an [immutable data storage](https://docs.microsoft.com/azure/storage/blobs/storage-blob-immutable-storage) option known as Write-Once, Read many (WORM) for this scenario. -->
