<span data-ttu-id="cbdd7-101">För att lastbalanseraren ska fungera korrekt måste du konfigurera inställningar som styr lastbalanserarens beteende.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-101">Before the load balancer will function correctly, you must configure settings that control the load balancer's behavior.</span></span> <span data-ttu-id="cbdd7-102">Här går du igenom konfiguration av nätverket, hälsoavsökning, säkerhetsregler, lastbalanseringsregler och serverpoolen.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-102">Here, you will look at configuring the network, health probe, security rules, load-balancing rules, and server pool.</span></span>

## <a name="steps-for-configuring-a-basic-public-load-balancer"></a><span data-ttu-id="cbdd7-103">Steg för att konfigurera en grundläggande offentlig lastbalanserare</span><span class="sxs-lookup"><span data-stu-id="cbdd7-103">Steps for configuring a basic public load balancer</span></span>

<span data-ttu-id="cbdd7-104">Följande är en översikt över de huvudsakliga konfigurationsstegen för en grundläggande offentlig lastbalanserare.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-104">The following is an overview of the main configuration steps for a basic public load balancer.</span></span> <span data-ttu-id="cbdd7-105">Stegen för en standard lastbalanserare och för en intern lastbalanserare kommer att vara liknande.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-105">The steps for a standard load balancer and for an internal load balancer will be similar.</span></span> <span data-ttu-id="cbdd7-106">Det finns i huvudsak fyra saker vi måste installera:</span><span class="sxs-lookup"><span data-stu-id="cbdd7-106">There are essentially four things we need to setup:</span></span>

- <span data-ttu-id="cbdd7-107">Backend-servrar för att bearbeta begäranden</span><span class="sxs-lookup"><span data-stu-id="cbdd7-107">Backend servers to process requests</span></span>
- <span data-ttu-id="cbdd7-108">Offentlig IP-adress</span><span class="sxs-lookup"><span data-stu-id="cbdd7-108">Public IP address</span></span>
- <span data-ttu-id="cbdd7-109">Hälsoavsökning</span><span class="sxs-lookup"><span data-stu-id="cbdd7-109">Health probe</span></span>
- <span data-ttu-id="cbdd7-110">Regler för lastbalanserare</span><span class="sxs-lookup"><span data-stu-id="cbdd7-110">Load balancer rules</span></span>

### <a name="backend-servers"></a><span data-ttu-id="cbdd7-111">Serverdelsservrar</span><span class="sxs-lookup"><span data-stu-id="cbdd7-111">Backend servers</span></span>

<span data-ttu-id="cbdd7-112">Först måste du konfigurera din pool med virtuella serverdelsdatorer.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-112">First, you need to configure your backend VM pool.</span></span> <span data-ttu-id="cbdd7-113">De virtuella datorerna ska vara i samma tillgänglighetsuppsättning och ha sina egna offentliga IP-adresser (även om detta inte faktiskt används av dina offentliga slutpunkter).</span><span class="sxs-lookup"><span data-stu-id="cbdd7-113">The VMs should be in the same availability set and have their own public IP address (although this will not actually be used by your public endpoints).</span></span>

<span data-ttu-id="cbdd7-114">Du måste skapa ett nytt virtuellt nätverk och definiera ett undernät som VM-poolen ska använda.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-114">You must create a new virtual network and define a subnet for the VM pool to use.</span></span>

 <span data-ttu-id="cbdd7-115">När du har flera virtuella datorer som tillhandahåller samma tjänster bör du använda en **nätverkssäkerhetsgrupp (NSG)** för att se till att samma brandväggsregler används i hela VM-poolen (även om det här inte är en del av den faktiska lastbalanseringsprocessen).</span><span class="sxs-lookup"><span data-stu-id="cbdd7-115">When you have multiple VMs providing the same services, you should use a **network security group (NSG)** to ensure that the same firewall rules are in place across the VM pool (although this is not part of the actual load-balancing process).</span></span> <span data-ttu-id="cbdd7-116">För virtuella datorer som är värd för webbprogram behöver du till exempel skapa inkommande säkerhetsregler på port 80 för HTTP och port 8080 för HTTPS.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-116">For example, for VMs hosting web applications, you will need to create inbound security rules on port 80 for HTTP or port 8080 for HTTPS.</span></span>

### <a name="public-ip-address"></a><span data-ttu-id="cbdd7-117">Offentlig IP-adress</span><span class="sxs-lookup"><span data-stu-id="cbdd7-117">Public IP address</span></span>

<span data-ttu-id="cbdd7-118">När du skapar en offentlig grundläggande lastbalanserare med hjälp av portalen konfigureras den **offentliga IP-adressen** automatiskt som lastbalanserarens främre del.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-118">When you create a public basic load balancer using the portal, the **public IP address** is automatically configured as the load balancer front end.</span></span>

<span data-ttu-id="cbdd7-119">En del av konfigurationen av lastbalanseraren är **serverdelsadresspoolen**, som innehåller IP-adresserna för varje virtuella dators nätverkskort som är anslutet till lastbalanseraren och används för att distribuera trafik till de virtuella datorerna.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-119">Part of the configuration of the load balancer is the **backend address pool**, containing the IP addresses of each VM's virtual NICs that are connected to the load balancer and used to distribute traffic to the VMs.</span></span>

### <a name="health-probe"></a><span data-ttu-id="cbdd7-120">Hälsoavsökning</span><span class="sxs-lookup"><span data-stu-id="cbdd7-120">Health probe</span></span>

<span data-ttu-id="cbdd7-121">Hälsoavsökningen lägger till eller tar bort virtuella datorer dynamiskt från lastbalanserarens rotation baserat på deras svar på hälsokontroller.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-121">The health probe dynamically adds or removes VMs from the load balancer rotation based on their response to health checks.</span></span> <span data-ttu-id="cbdd7-122">Som standard är det 15 sekunder mellan avsökningsförsöken.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-122">By default, there are 15 seconds between probe attempts.</span></span> <span data-ttu-id="cbdd7-123">Efter två avsökningsfel betraktas en virtuell dator som defekt och trafik  dirigeras inte dit tills servern är online igen.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-123">After two consecutive probe failures, a VM is considered unhealthy and traffic won't be routed there until the server comes back online.</span></span>

### <a name="rules"></a><span data-ttu-id="cbdd7-124">Regler</span><span class="sxs-lookup"><span data-stu-id="cbdd7-124">Rules</span></span>

<span data-ttu-id="cbdd7-125">Lastbalanserarens regel identifierar den port som Lastbalanseraren lyssnar på och den port som används för att skicka trafik till virtuella datorers bakre del.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-125">The load balancer rules identify the port(s) that the load balancer is listening on, and the port(s) used to send traffic to the back end set of VMs.</span></span> <span data-ttu-id="cbdd7-126">Du behöver minst en regel för att dirigera trafik.</span><span class="sxs-lookup"><span data-stu-id="cbdd7-126">You need at least one rule to route traffic.</span></span>
