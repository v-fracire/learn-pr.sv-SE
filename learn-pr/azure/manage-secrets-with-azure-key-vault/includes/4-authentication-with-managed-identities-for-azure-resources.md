<span data-ttu-id="849d5-101">Azure Key Vault använder **Azure Active Directory** till att autentisera användare och program som försöker få åtkomst till ett valv.</span><span class="sxs-lookup"><span data-stu-id="849d5-101">Azure Key Vault uses **Azure Active Directory** to authenticate users and applications that try to access a vault.</span></span> <span data-ttu-id="849d5-102">För att ge vår webbapp åtkomst till valvet, måste vi först registrera appen med Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="849d5-102">To grant our web application access to the vault, we first need to register our app with Azure Active Directory.</span></span> <span data-ttu-id="849d5-103">Vid registreringen skapas en identitet för appen.</span><span class="sxs-lookup"><span data-stu-id="849d5-103">Registering creates an identity for the app.</span></span> <span data-ttu-id="849d5-104">När appen har en identitet kan vi tilldela valvbehörigheter till den.</span><span class="sxs-lookup"><span data-stu-id="849d5-104">Once the app has an identity, we can assign vault permissions to it.</span></span>

<span data-ttu-id="849d5-105">Appar och användare autentiserar till Key Vault med hjälp av en Azure Active Directory-autentiseringstoken.</span><span class="sxs-lookup"><span data-stu-id="849d5-105">Apps and users authenticate to Key Vault using an Azure Active Directory authentication token.</span></span> <span data-ttu-id="849d5-106">För att få en token från Azure Active Directory krävs en hemlighet eller ett certifikat, eftersom alla med en token kan använda programidentiteten för att komma åt samtliga hemligheter i valvet.</span><span class="sxs-lookup"><span data-stu-id="849d5-106">Getting a token from Azure Active Directory requires a secret or certificate, because anyone with a token could use the application identity to access all of the secrets in the vault.</span></span>

<span data-ttu-id="849d5-107">Våra programhemligheter är säkra i valvet, men vi måste ha en hemlighet eller ett certifikat utanför valvet för att komma åt dem!</span><span class="sxs-lookup"><span data-stu-id="849d5-107">Our application secrets are secure in the vault, but we still need to keep a secret or certificate outside of the vault in order to access them!</span></span> <span data-ttu-id="849d5-108">Det här problemet kallas för *startproblemet*, och Azure har en lösning.</span><span class="sxs-lookup"><span data-stu-id="849d5-108">This problem is called the *bootstrapping problem*, and Azure has a solution for it.</span></span>

## <a name="managed-identities-for-azure-resources"></a><span data-ttu-id="849d5-109">Hanterade identiteter för Azure-resurser</span><span class="sxs-lookup"><span data-stu-id="849d5-109">Managed identities for Azure resources</span></span>

<span data-ttu-id="849d5-110">Hanterade identiteter för Azure-resurser är en Azure-funktion som din app kan använda för att få åtkomst till Key Vault och andra Azure-tjänster utan att behöva hantera en enda hemlighet utanför valvet.</span><span class="sxs-lookup"><span data-stu-id="849d5-110">Managed identities for Azure resources is an Azure feature that your app can use to access Key Vault and other Azure services without having to manage even a single secret outside of the vault.</span></span> <span data-ttu-id="849d5-111">Att använda hanterad identitet är ett enkelt och säkert sätt att utnyttja Key Vault från din webbapp.</span><span class="sxs-lookup"><span data-stu-id="849d5-111">Using a managed identity is a simple and secure way to take advantage of Key Vault from your web app.</span></span>

<span data-ttu-id="849d5-112">När du aktiverar hanterad identitet på din webbapp aktiverar Azure en separat tokenbeviljande REST-tjänst som ska användas specifikt av din app.</span><span class="sxs-lookup"><span data-stu-id="849d5-112">When you enable managed identity on your web app, Azure activates a separate token-granting REST service specifically for use by your app.</span></span> <span data-ttu-id="849d5-113">Appen kommer att begära token från den här tjänsten i stället för direkt från Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="849d5-113">Your app will request tokens from this service instead of directly from Azure Active Directory.</span></span> <span data-ttu-id="849d5-114">Din app måste använda en hemlighet för att få åtkomst till den här tjänsten, men den hemligheten matas in i appens miljövariabler med App Service när den startas.</span><span class="sxs-lookup"><span data-stu-id="849d5-114">Your app needs to use a secret to access this service, but that secret is injected into your app's environment variables by App Service when it starts up.</span></span> <span data-ttu-id="849d5-115">Du behöver inte hantera eller lagra det här hemliga värdet någonstans, och inget utanför appen kan komma åt den här hemligheten eller den hanterade identitetens tokentjänstslutpunkt.</span><span class="sxs-lookup"><span data-stu-id="849d5-115">You don't need to manage or store this secret value anywhere, and nothing outside of your app can access this secret or the managed identity token service endpoint.</span></span>

<span data-ttu-id="849d5-116">Hanterade identiteter för Azure-resurser registrerar även din app i Azure Active Directory åt dig och tar bort registreringen om du tar bort webbappen eller inaktiverar dess hanterade identitet.</span><span class="sxs-lookup"><span data-stu-id="849d5-116">Managed identities for Azure resources also registers your app in Azure Active Directory for you, and will delete the registration if you delete the web app or disable its managed identity.</span></span>

<span data-ttu-id="849d5-117">Hanterade identiteter är tillgängliga i alla utgåvor av Azure Active Directory, inklusive den kostnadsfria versionen som ingår i en Azure-prenumeration.</span><span class="sxs-lookup"><span data-stu-id="849d5-117">Managed identities are available in all editions of Azure Active Directory, including the Free edition included with an Azure subscription.</span></span> <span data-ttu-id="849d5-118">Att använda dem i App Service medför inte någon extra kostnad och kräver inte någon konfiguration. De kan aktiveras eller inaktiveras i en app när som helst.</span><span class="sxs-lookup"><span data-stu-id="849d5-118">Using it in App Service has no extra cost and requires no configuration, and it can be enabled or disabled on an app at any time.</span></span>

> [!NOTE]
> <span data-ttu-id="849d5-119">Hanterade identiteter för Azure-resurser stöds inte för Linux eller containerwebbappar för närvarande.</span><span class="sxs-lookup"><span data-stu-id="849d5-119">Managed identities for Azure resources is not currently supported for Linux or Container web apps.</span></span>

<span data-ttu-id="849d5-120">När du aktiverar en hanterad identitet för en webbapp krävs bara ett enda Azure CLI-kommando utan konfiguration.</span><span class="sxs-lookup"><span data-stu-id="849d5-120">Enabling a managed identity for a web app requires only a single Azure CLI command with no configuration.</span></span> <span data-ttu-id="849d5-121">Vi ska göra detta senare när vi konfigurerar en App Service-app och distribuerar den till Azure.</span><span class="sxs-lookup"><span data-stu-id="849d5-121">We'll do it later on when we set up an App Service app and deploy to Azure.</span></span> <span data-ttu-id="849d5-122">Innan dess ska vi dock använda vår kunskap om hanterade identiteter till att skriva koden för appen.</span><span class="sxs-lookup"><span data-stu-id="849d5-122">Before that, though, we're going to apply our knowledge of managed identities to write the code for our app.</span></span>